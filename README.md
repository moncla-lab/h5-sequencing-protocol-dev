January 26, 2023 

The purpose of this repository is to find complete influenza gene segments that we can use to generate artificial RNA libraries to test our sequencing pipeline. We will be sequencing residual RNA from animals that were naturally infected with H5N1 in North America. These samples may be degraded and may contain low viral RNA input copies. It will therefore be useful to test our amplification protocol using artificial RNA that is abundant. Furthermore, testing serial dilutions of these artificial RNAs will help us determine the raw error rate of our pipeline given different input copies and PCR cycling conditions. This will be important for ensuring that our consensus genomes are accurate, evaluating appropriate Ct cutoffs for samples to sequence, and for determining whether we can use this approach and these types of samples to look at within-host diversity. 

The challenge with H5N1 is that it is a select agent, so we can't generate viruses and grow them in the lab safetly. Even using 6:2 reassortants would not be appropriate in this scenario, because we want to make sure that we can amplify the internal genes in addition to the HA and NA. So instead, we are going to generate artificial libraries of synthetic, clonal RNAs that we can then use to test and develop our protocol. We will do this by ordering plasmids that encode DNA matching currently circulating H5N1 viruses in North America, and performing in vitro transcription to generate artificial influenza genomes. 
We can then use that RNA to test our reverse transcription and PCR protocols, and optimize them using non-previous samples. 

For PCR amplification, we will be using the Hoffman universal primers that bind to the influenza uni12 and uni13 sequences, which are at the very ends of each influenza gene segment. From past testing, I have had better success getting equal amplification across the long and short segments by using segment-specific primers that include an additional 2-3 bases internal to the uni12 and 13 sequences. This provides some segment specificity and reduces the likelihood of generating enormous quantities of NS and insufficient PB2. Because this is where our primers are binding, we need to make sure that the artificial RNA that we generate includes these sequences, including the full noncoding regions. This is a challenge because many influenza sequences do not include the noncoding regions of the RNA. We would like to use the A/domestic goose/NL/FAV003517/2021 strain as our test strain for this protocol, because it represents a basal sample from the start of the North American outbreak. All 8 gene segments still are related to viruses now circulating in North America, so this remains a reasonable test strain. However, this strain does not include the full noncoding regions. To rectify this, I did the following: 

1. Using all H5Nx viruses, generated an alignment for each gene segment. 
2. Using `scripts/find-complete-cds.ipynb`, pull out all sequences from 2021-2022 that start with uni12 and end with uni13 + the `A/domestic goose/NL/FAV003517/2021` strain and write to a new alignment file. 
3. Examine these sequences to determine how much noncoding region is missing from `A/domestic goose/NL/FAV003517/2021`.
4. Append the conserved, noncoding regions onto the ends of `A/domestic goose/NL/FAV003517/2021` to generate our artificial, "full segments"
5. Because we would like to generate RNA corresponding to influenza, genomic RNA which is negative sense (3' to 5'), we need to make sure that our plasmid DNA, when transcribed in vitro, will yield RNA in the correct orientation. To do so, we need to reverse the DNA. So for each complete segment, I then reversed the sequence. 

HA and NS did not contain any sequences with both a uni12 and uni13, nor did the alignments contain either a uni12 or uni13. For those, I went into the alignment insertions/deletions output file and can see that these sequences just got cut off. So I added them back in. 